<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Product Management</title>
<style>
  :root {
    --border:#0c0c0c;
    --head:#eee;
    --even:#f7f7f7;
    --text:#222;
  }

  table {
    border-collapse: collapse;
  }
  thead th {
    background: var(--head);
    border: 1px solid var(--border);
    padding: 10px 8px;
    font-weight: 700;
    font-size: 13px;
    text-align: center;
  }
  tbody td {
    border: 1px solid var(--border);
    padding: 12px 10px;
    font-size: 14px;
    text-align: center;
  }
  tbody tr:nth-child(even) { background: var(--even); }

  .add-row {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
  }

  .add-row > div {
    margin-right: 15px;
  }

  .add-row input {
    width: 180px;
    font-size: 14px;
  }
</style>
</head>
<body>
  <div class="table-wrap">
    <table id="productTable" aria-label="Products">
      <thead>
        <tr>
          <th>Product Name</th>
          <th>Product Category</th>
          <th>Product Price</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="productBody">
        <!-- rows injected by JS -->
      </tbody>
    </table>
  </div>

  <hr class="rule" />

  <h2 class="section-title">Add Product</h2>
  <div class="add-row" id="addForm" role="form">
    <div>
      <label for="name">Product Name:</label>
      <input id="name" type="text" />
    </div>
    <div>
      <label for="category">Product Category:</label>
      <input id="category" type="text" />
    </div>
    <div>
      <label for="price">Product Price:</label>
      <input id="price" class="price" type="text" />
    </div>
    <button id="addBtn" class="btn add-btn" type="button">Add New</button>
    <div class="hint" id="hint"></div>
  </div>

<script>
  // ----- Default rows (shown every time the file opens) -----
  const DEFAULT_ROWS = [
    { name: "M&M",   category: "Snacks",     price: 1.99 },
    { name: "Table", category: "Furniture",  price: 199   },
    { name: "Kale",  category: "Vegetables", price: 2.49  }
  ];

  const $ = (sel) => document.querySelector(sel);
  const tbody = $("#productBody");
  const nameInp = $("#name");
  const catInp = $("#category");
  const priceInp = $("#price");

  function toCurrency(n) {
    // Format as $x.xx (accept integers)
    let price_number = Number(n);
    return `$${price_number}`;
  }

  function parsePrice(input) {
    // Strip $ and commas; allow "1,999.95" or "$2.5"
    const cleaned = String(input).replace(/[^0-9.]/g, "");
    if (cleaned === "") return NaN;
    return parseFloat(cleaned);
  }

  function renderRow({ name, category, price }) {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${name}</td>
      <td>${category}</td>
      <td>${toCurrency(price)}</td>
      <td><button class="btn btn-danger delete">Delete</button></td>
    `;
    tbody.appendChild(tr);
  }

  function loadDefaults() {
    tbody.innerHTML = "";
    DEFAULT_ROWS.forEach(renderRow);
  }

  // ----- Add new product -----
  function addProduct() {
    hint.textContent = "";
    const name = nameInp.value.trim();
    const category = catInp.value.trim();
    const priceVal = parsePrice(priceInp.value);

    if (!name || !category || !Number.isFinite(priceVal)) {
      hint.textContent = "Please fill out all fields with a valid price.";
      return;
    }

    renderRow({ name, category, price: priceVal });

    // Clear inputs & focus first field (requirement b)
    nameInp.value = "";
    catInp.value = "";
    priceInp.value = "";
    nameInp.focus();
  }

  // ----- Delete via event delegation (requirement c) -----
  tbody.addEventListener("click", (e) => {
    if (e.target.matches(".delete")) {
      e.target.closest("tr").remove();
    }
  });

  // Add button + Enter key support
  $("#addBtn").addEventListener("click", addProduct);
  document.getElementById("addForm").addEventListener("keydown", (e) => {
    if (e.key === "Enter") {
      e.preventDefault();
      addProduct();
    }
  });

  // Initial render (requirement d)
  loadDefaults();
</script>
</body>
</html>
